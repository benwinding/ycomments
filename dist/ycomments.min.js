var ycomments=function(){function t(t){return new Promise((e,n)=>{var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState){200!=this.status&&n(this.statusText);var t=JSON.parse(this.responseText);e(t)}},o.open("GET",t,!0),o.send(null)})}function e(t){const e=new URL(t);return e.host+e.pathname+e.search}function n(n){const o=new URL(n),r=o.host;if(["news.ycombinator.com"].indexOf(r)>=0)return Promise.reject("Hacker News API: Not going to search domain: Hacker News");let i=o.href,s="https://hn.algolia.com/api/v1/search?query="+encodeURIComponent(e(i))+"&restrictSearchableAttributes=url";new XMLHttpRequest;return t(s).then(t=>(function(t){if(0==t.nbHits)return Promise.reject("Hacker News API: No urls found");let n,o=t.hits,r=0;for(let t of o)s=t.url,a=i,e(s)==e(a)&&t.num_comments>=r&&(r=t.num_comments,n=t);var s,a;if(null==n)return Promise.reject("Hacker News API: No url matches found");result_id=n.objectID,result_title=n.title,result_author=n.author;const c=`https://news.ycombinator.com/item?id=${result_id}`;return{id:result_id,link:c,comments:r,title:result_title,author:result_author}})(t)).catch(t=>Promise.reject(t))}function o(t,e){return t.children.length>e.children.length?-1:t.children.length<e.children.length?1:t.created_at>e.created_at?-1:t.created_at<e.created_at?1:0}function r(t,e){let n=document.createElement("div");n.setAttribute("class","ycomments-child");let o=new Date(t.created_at),i=o.toLocaleDateString()+" - "+o.toLocaleTimeString(),s=t.text.trim(),a=t.author;const c=`\n      <div class="ycomments-content">\n        <div class="ycomments-meta">\n          <a class="ycomments-author" href="${"https://news.ycombinator.com/user?id="+a}" target="_blank">${a}</a>\n          <span>${i}</span>\n          <a class="ycomments-toggle" onclick="onClickToggle(this)" >[-]</a>\n        </div>\n        <div class="ycomments-text">${s}</div>\n      </div>\n    `;n.insertAdjacentHTML("beforeend",c),e.appendChild(n);for(const e of t.children)r(e,n)}return{getHnCommentsNode:function(e){let i;return n(e).then(e=>(i=e,function(e){return t(`https://hn.algolia.com/api/v1/items/${e}`).then(t=>t.children.sort(o))}(e.id))).then(t=>({node:function(t){let e=document.createElement("div");e.setAttribute("class","ycomments-root");for(const n of t)r(n,e);const n=`<script>${function(t){const e=t.parentElement.parentElement.parentElement;"[-]"==t.innerText?(e.style.height="10px",t.innerText="[+]"):(e.style.height="unset",t.innerText="[-]")}.toString()}<\/script>`;return e.insertAdjacentHTML("beforeend",n),e}(t),results:i})).catch(t=>console.error(t))}}}();function onLoadYcomments(){let t=window.location.href;ycomments.getHnCommentsNode(t).then(t=>{let e=document.createElement("iframe");e.style.opacity="0",e.setAttribute("name","ycomments"),e.setAttribute("width","100%"),e.setAttribute("frameBorder","0"),e.setAttribute("scrolling","no"),e.addEventListener("load",function(){var n=e.contentWindow.document;n.open(),n.write(t.node.outerHTML);var o=document.createElement("style");o.innerText="\nhtml, body {\n  left: 0px;\n  right: 0px;\n  margin-left: 0px;\n  width: 100% !important;\n  display: block !important;\n  background-color: #f6f6ef;\n  font-family: Verdana, Geneva, sans-serif;\n}\n\n.ycomments-root {\n  width: 100%;\n  margin-left: -10px;\n}\n\n.ycomments-header {\n  width: 100%;\n  padding-left: 10px;\n  padding-right: 10px;\n}\n\n.ycomments-header h1 a,\n.ycomments-header h1 {\n  font-size: 12pt;\n  color: black;\n  margin-bottom: 6px;\n}\n\n.ycomments-header h1 a:visited {\n  color: grey;\n}\n\n.ycomments-header p a,\n.ycomments-header p {\n  font-size: 10pt;\n  color: grey;\n  padding: 0;\n  margin-top: 0;\n  margin-right: 6px;\n}\n\n.ycomments-child {\n  margin-left: 10px;\n  padding: 10px;\n  padding-top: 5px;\n  right: 0px;\n  left: 0px;\n  position: relative;\n  font-size: 9pt;\n}\n\n.ycomments-content {\n  margin-bottom: -10px;\n}\n\n.ycomments-content a:hover {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\n.ycomments-meta, .ycomments-author {\n  color: grey;\n}\n\n.ycomments-author {\n  margin-right: 7px;\n}\n\n.ycomments-child p {\n  margin-top: 5px;\n}\n\n.ycomments-child pre {\n  color: black;\n  overflow-x: scroll;\n  background-color: #f7f7f7;\n}\n\n        ",n.head.appendChild(o);let r=t.results.author,i="https://news.ycombinator.com/user?id="+r,s=t.results.title,a="https://news.ycombinator.com/item?id="+t.results.id;const c=`\n          <div class="ycomments-header">\n            <h1><a href="${a}" target="_blank">${s}</a></h1>\n            <p>by <a href="${i}" target="_blank">${r}</a>\n            <a href="${a}" target="_blank">10 comments</a>\n            </p>\n          </div>\n        `;n.body.insertAdjacentHTML("afterbegin",c),n.close(),e.style.WebkitTransition="opacity 1s",e.style.MozTransition="opacity 1s",e.style.height=n.body.scrollHeight+"px",e.style.opacity="1"}),document.querySelector('[from="hn"]').appendChild(e)}).catch(t=>console.error(t))}window.addEventListener("load",onLoadYcomments);